{% extends "layout/base.html" %}
{% load staticfiles %}

{% block content %}
<div class="container-fluid">
    <div class="row center-xs">
        <h2 class="text-dark">Manage Boxes</h2>
        <div class="col-xs-12">
            <ul class="box__nav">
                <li class=""><a href="{% url "boxes_list" %}?display=Open" class="box__nav__item {% if display_status == 'Open' %}active{% endif %}">Open</a></li>
                <li ><a href="{% url "boxes_list" %}?display=Done"class="box__nav__item {% if display_status == 'Done' %}active{% endif %}">Done</a></li>
                <li ><a href="{% url "boxes_list" %}?display=Expired" class="box__nav__item {% if display_status == 'Expired' %}active{% endif %}">Expired</a></li>
                <li ><a href="{% url "boxes_list" %}?display=Closed" class="box__nav__item {% if display_status == 'Closed' %}active{% endif %}">Closed</a></li>
            </ul>
        </div>
    </div>
    <div class="row">
        {% for box in object_list %}
            <div class="col-xxs-12 col-xs-6 col-sm-6 col-md-4">
                <div class="box">
                    <h3 class="box__title">{{box.name}}</h3>
                    <p class="box__desc">{{box.description}}</p>

                    <input type="text" value="https://{{domain}}{% url "boxes_show" box.uuid %}" id="box-{{box.id}}-url"></input>
                    <button class="btn-dark copy-to-clipboard-js" data-src='box-{{box.id}}-url'>Copy the above URL</button>

                    <p>Messages:{{box.messages.count}}/{{box.max_messages}}</p>

                    <p class="box__info">
                        <span class="text-dark text-bold">Created on:</span>
                        <span>{{box.created_at}}</span>
                    </p>
                    {% if box.expires_at %}
                    <p class="box__info">
                        <span class="text-dark text-bold">Expires on:</span>
                        <span>{{box.expires_at}}</span>
                    </p>
                    {% endif %}
                    {% if box.messages.count %}
                    <p class="box__info">
                        <span class="text-dark text-bold">Last sent:</span>
                        <span>{{box.last_sent_at}}</span>
                    </p>
                    {% endif %}
                    {% if box.status == allow_actions %}
                        <form action="{% url "boxes_close" box.id %}" method="post">
                            {% csrf_token %}
                            <input class="btn-dark" type="submit" value="Close"></input>
                        </form>
                        <form action="{% url "boxes_delete" box.id %}" method="post">
                            {% csrf_token %}
                            <input class="btn-dark" type="submit" value="Delete"></input>
                        </form>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
    <div class="pagination">
        <span class="step-links">
            {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}&amp;display={{ display_status }}"> &lt; Previous</a>
            {% endif %}

            {% if paginator.num_pages > 1 %}
                <span class="current">
                   Page {{ page_obj.number }} of {{ paginator.num_pages }}
                </span>
            {% endif %}

            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}&amp;display={{ display_status }}">Next &gt; </a>
            {% endif %}
        </span>
    </div>
</div>
{% endblock content %}

{% block scripts %}
    <script src="{% static 'javascripts/box_list.js' %}"></script>
{% endblock scripts %}
